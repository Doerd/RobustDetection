
#!/usr/Anaconda3/python3

import numpy as np
from scipy import signal
import scipy
import wfdb
from matplotlib import pyplot
import random
import math
#np.set_printoptions(threshold=np.nan)

path = "C:\\Users\\williamadriance\\My Documents\\RobustDetection\\entry\\challenge\\2014\\"

use_setp = False

if use_setp:
	path += "set-p\\"
else:
	path += "training\\"


import os
arr = os.listdir(path)
files = [arr[i] for i in range(1,len(arr),3)]
readfile = random.choice(files)
filedir = path + "1016xxxx"#readfile

######################LIST OF IMPORTANT RECORDS############################
# 2923 ---> fairly stable
# 1028 ---> incredibly difficult
# 1866 ---> good example of PACs
###########################################################################

filedir = filedir[:len(filedir)-4]




print("Record number: " + readfile[:len(readfile)-4])


sig, fields = wfdb.rdsamp(filedir, channels=[0])

annsamp=wfdb.rdann(filedir, 'atr')[0]
#print("annsamp: ", annsamp)
#print(fields)

sig_train = []
sig_test = []
ann_train = []
ann_test = []

from time import time
'''
t0 = time()
for i in range(0, 80):
	sig_train.append(wfdb.rdsamp(path+str(100+i), channels=[0])[0])
	ann_train.append(wfdb.rdann(path+str(100+i), 'atr')[0])[0]
for i in range(80, 100):
	sig_test.append(wfdb.rdsamp(path+str(100+i), channels=[0])[0])
	ann_test.append(wfdb.rdann(path+str(100+i), 'atr')[0])
t1 = time()
print("time taken for array creation: ", str(t1-t0)[:5], "seconds")'''

def array_derivative(arr, order):
	if order==0:
		return arr
	else:
		ret = []
		for i in range(len(arr)-1):
			ret.append(arr[i+1]-arr[i])
		return array_derivative(ret, order-1)
	
def array_power(arr, power):
	return [n**power for n in arr]

def abs_array_power(arr, power):
	return [abs(n**power) for n in arr]

def normalize_array(arr, ran):
	m = max(arr) if max(arr) > abs(min(arr)) else abs(min(arr))
	return [n*(ran/m) for n in arr]

def ann_to_plot(sig, ann, height):
	ann = [a for a in ann if a > 0]
	annnew = []
	count = 0
	for i in range(len(sig)):
		if count < len(ann) and ann[count] == i:
			annnew.append(height)
			count += 1
		else:
			annnew.append(0)
	return annnew

sig = sig[:,0]





'''
sig_avg = sum(sig)/len(sig)
print("average: ", sig_avg)

sig = [n-sig_avg for n in sig]

avg_arr = [sig_avg for n in range(len(sig))]


threshold = (sum([abs(number) for number in sig])/len(sig))
my_guess = [0.3 if n > threshold or n < -1*threshold else 0 for n in sig]
'''

###########
#  Start  #
#   of    #
#  window #
###########

def max_index(arr):
	index = 0
	for i in range(len(arr)):
		if arr[i]>arr[index]:
			index = i
	return index

init_window_width = 190
window_width = init_window_width

windowing_result_plotform = [0]*len(sig)
windows_plotted = []

ann_guess = []
arrays_windows = []



arr = sig
#sig = [abs(n) for n in sig]
#sig = np.convolve(sig, h)

sigavg = np.mean(sig)

'''
highpass
h = [
    0.000000000000000000,
    0.000000688079373601,
    0.000002799557647008,
    0.000006390551560924,
    0.000011495910890062,
    0.000018126769350187,
    0.000026267561437421,
    0.000035872511549462,
    0.000046861621172260,
    0.000059116199713020,
    0.000072474004268640,
    0.000086724072775932,
    0.000101601353133805,
    0.000116781247565362,
    0.000131874206265455,
    0.000146420516850878,
    0.000159885445927178,
    0.000171654895884503,
    0.000181031743564161,
    0.000187233027486367,
    0.000189388146751443,
    0.000186538227444618,
    0.000177636801383594,
    0.000161551927417890,
    0.000137069867363280,
    0.000102900407250769,
    0.000057683890175337,
    0.000000000000000000,
    -0.000071621694078304,
    -0.000158689453091544,
    -0.000262735397209543,
    -0.000385299934112298,
    -0.000527914705930231,
    -0.000692084206327874,
    -0.000879266250649455,
    -0.001090851511652298,
    -0.001328142360632854,
    -0.001592331278134224,
    -0.001884479119383697,
    -0.002205493536662410,
    -0.002556107873532196,
    -0.002936860853878784,
    -0.003348077391791147,
    -0.003789850846180116,
    -0.004262027036626731,
    -0.004764190324213116,
    -0.005295652043088243,
    -0.005855441545411769,
    -0.006442300094346390,
    -0.007054677807265955,
    -0.007690733814729550,
    -0.008348339760535652,
    -0.009025086724880636,
    -0.009718295606928426,
    -0.010425030955632788,
    -0.011142118189159209,
    -0.011866164094479255,
    -0.012593580450421860,
    -0.013320610570433083,
    -0.014043358516278881,
    -0.014757820691663238,
    -0.015459919485929847,
    -0.016145538603326588,
    -0.016810559683336460,
    -0.017450899792844816,
    -0.018062549351871984,
    -0.018641610041614874,
    -0.019184332236881665,
    -0.019687151504839816,
    -0.020146723718398579,
    -0.020559958345475915,
    -0.020924049494716185,
    -0.021236504323685609,
    -0.021495168446835116,
    -0.021698248017147887,
    -0.021844328196858394,
    -0.021932387778338173,
    0.978038190234480798,
    -0.021932387778338173,
    -0.021844328196858394,
    -0.021698248017147887,
    -0.021495168446835120,
    -0.021236504323685613,
    -0.020924049494716185,
    -0.020559958345475915,
    -0.020146723718398579,
    -0.019687151504839819,
    -0.019184332236881669,
    -0.018641610041614881,
    -0.018062549351871991,
    -0.017450899792844816,
    -0.016810559683336460,
    -0.016145538603326591,
    -0.015459919485929849,
    -0.014757820691663238,
    -0.014043358516278880,
    -0.013320610570433083,
    -0.012593580450421865,
    -0.011866164094479258,
    -0.011142118189159210,
    -0.010425030955632787,
    -0.009718295606928426,
    -0.009025086724880638,
    -0.008348339760535652,
    -0.007690733814729546,
    -0.007054677807265956,
    -0.006442300094346392,
    -0.005855441545411768,
    -0.005295652043088247,
    -0.004764190324213121,
    -0.004262027036626734,
    -0.003789850846180116,
    -0.003348077391791147,
    -0.002936860853878787,
    -0.002556107873532196,
    -0.002205493536662408,
    -0.001884479119383697,
    -0.001592331278134225,
    -0.001328142360632854,
    -0.001090851511652299,
    -0.000879266250649456,
    -0.000692084206327874,
    -0.000527914705930231,
    -0.000385299934112298,
    -0.000262735397209543,
    -0.000158689453091545,
    -0.000071621694078304,
    0.000000000000000000,
    0.000057683890175337,
    0.000102900407250769,
    0.000137069867363281,
    0.000161551927417890,
    0.000177636801383594,
    0.000186538227444618,
    0.000189388146751443,
    0.000187233027486367,
    0.000181031743564161,
    0.000171654895884503,
    0.000159885445927178,
    0.000146420516850878,
    0.000131874206265456,
    0.000116781247565362,
    0.000101601353133805,
    0.000086724072775932,
    0.000072474004268640,
    0.000059116199713020,
    0.000046861621172260,
    0.000035872511549462,
    0.000026267561437421,
    0.000018126769350187,
    0.000011495910890062,
    0.000006390551560924,
    0.000002799557647008,
    0.000000688079373601,
    0.000000000000000000,
]
'''
#bandpass first try
h = [
	-0.000000000000000004,
    0.000000000000000006,
    0.000000000001797150,
    0.000000000029288704,
    0.000000000190634088,
    0.000000000773181814,
    0.000000002318789327,
    0.000000005597090258,
    0.000000011395199381,
    0.000000020088545403,
    0.000000031048419486,
    0.000000042056271477,
    0.000000048991687646,
    0.000000046088866380,
    0.000000026971261953,
    -0.000000013538914075,
    -0.000000077148377579,
    -0.000000159990424237,
    -0.000000251537292263,
    -0.000000335351729788,
    -0.000000392170404971,
    -0.000000405177299625,
    -0.000000366509856686,
    -0.000000283268949257,
    -0.000000180853556360,
    -0.000000101562925569,
    -0.000000097235965681,
    -0.000000216174231551,
    -0.000000486453823880,
    -0.000000899533830705,
    -0.000001399305466424,
    -0.000001881957190641,
    -0.000002211025471337,
    -0.000002249829831559,
    -0.000001910544150660,
    -0.000001216066221815,
    -0.000000368336347882,
    0.000000184555347944,
    -0.000000310102345058,
    -0.000002953800200907,
    -0.000009223819035383,
    -0.000020983491152616,
    -0.000040478938066300,
    -0.000070327239471426,
    -0.000113501224488192,
    -0.000173314812324166,
    -0.000253410441166769,
    -0.000359066398490777,
    -0.000505623444285444,
    -0.000705395709095397,
    -0.000954161077505681,
    -0.001227737488073425,
    -0.001488890960401580,
    -0.001704969926537052,
    -0.001872097865992825,
    -0.002037209693954834,
    -0.002306582519753216,
    -0.002830719808861126,
    -0.003761565655991918,
    -0.005188372193827253,
    -0.007070294662199777,
    -0.009192444176393347,
    -0.011172907360887260,
    -0.012538065856947243,
    -0.012862884894286813,
    -0.011946566689071580,
    -0.009970627702774099,
    -0.007575841201471001,
    -0.005804089340557301,
    -0.005882785277746301,
    -0.008877273719747208,
    -0.015287480081774316,
    -0.024702199131372796,
    -0.035632398617423344,
    -0.045615490605609710,
    -0.051618571801048660,
    -0.050684898951649737,
    -0.040687678880294939,
    -0.021003925893932150,
    0.007082064096143736,
    0.040384785870624343,
    0.074276309989355860,
    0.103524450406299873,
    0.123332139181715025,
    0.130337310755906405,
    0.123332139181714151,
    0.103524450406299651,
    0.074276309989356443,
    0.040384785870624294,
    0.007082064096143519,
    -0.021003925893932171,
    -0.040687678880295022,
    -0.050684898951649737,
    -0.051618571801048493,
    -0.045615490605609654,
    -0.035632398617423428,
    -0.024702199131372803,
    -0.015287480081774347,
    -0.008877273719747213,
    -0.005882785277746256,
    -0.005804089340557315,
    -0.007575841201471037,
    -0.009970627702774099,
    -0.011946566689071590,
    -0.012862884894286813,
    -0.012538065856947203,
    -0.011172907360887246,
    -0.009192444176393340,
    -0.007070294662199762,
    -0.005188372193827235,
    -0.003761565655991908,
    -0.002830719808861123,
    -0.002306582519753225,
    -0.002037209693954839,
    -0.001872097865992830,
    -0.001704969926537065,
    -0.001488890960401599,
    -0.001227737488073427,
    -0.000954161077505687,
    -0.000705395709095405,
    -0.000505623444285442,
    -0.000359066398490770,
    -0.000253410441166763,
    -0.000173314812324166,
    -0.000113501224488186,
    -0.000070327239471416,
    -0.000040478938066294,
    -0.000020983491152622,
    -0.000009223819035388,
    -0.000002953800200903,
    -0.000000310102345064,
    0.000000184555347935,
    -0.000000368336347881,
    -0.000001216066221805,
    -0.000001910544150655,
    -0.000002249829831568,
    -0.000002211025471342,
    -0.000001881957190641,
    -0.000001399305466427,
    -0.000000899533830712,
    -0.000000486453823883,
    -0.000000216174231545,
    -0.000000097235965682,
    -0.000000101562925578,
    -0.000000180853556364,
    -0.000000283268949256,
    -0.000000366509856688,
    -0.000000405177299636,
    -0.000000392170404987,
    -0.000000335351729787,
    -0.000000251537292264,
    -0.000000159990424251,
    -0.000000077148377585,
    -0.000000013538914072,
    0.000000026971261951,
    0.000000046088866375,
    0.000000048991687648,
    0.000000042056271483,
    0.000000031048419485,
    0.000000020088545398,
    0.000000011395199378,
    0.000000005597090263,
    0.000000002318789325,
    0.000000000773181808,
    0.000000000190634088,
    0.000000000029288708,
    0.000000000001797154,
    -0.000000000000000002,
    -0.000000000000000002,
]
'''
#bandpass next try
h = [
    -0.000000000000000004,
    0.000000000000000006,
    -0.000000000000000175,
    -0.000000000000001913,
    -0.000000000000010481,
    -0.000000000000038273,
    -0.000000000000107874,
    -0.000000000000252968,
    -0.000000000000516225,
    -0.000000000000942752,
    -0.000000000001569371,
    -0.000000000002410183,
    -0.000000000003440647,
    -0.000000000004582291,
    -0.000000000005691827,
    -0.000000000006557602,
    -0.000000000006906547,
    -0.000000000006423188,
    -0.000000000004781238,
    -0.000000000001685985,
    0.000000000003075878,
    0.000000000009584786,
    0.000000000017741560,
    0.000000000027233407,
    0.000000000037519197,
    0.000000000047840598,
    0.000000000057261895,
    0.000000000064739504,
    0.000000000069217103,
    0.000000000069739806,
    0.000000000065575994,
    0.000000000056333931,
    0.000000000042057724,
    0.000000000023288742,
    0.000000000001079425,
    -0.000000000023048475,
    -0.000000000047204967,
    -0.000000000069288109,
    -0.000000000087185714,
    -0.000000000099004971,
    -0.000000000103308087,
    -0.000000000099327495,
    -0.000000000087134371,
    -0.000000000067735281,
    -0.000000000043078082,
    -0.000000000015954906,
    0.000000000010198444,
    0.000000000031597058,
    0.000000000044473072,
    0.000000000045481994,
    0.000000000032108481,
    0.000000000003028070,
    -0.000000000041619859,
    -0.000000000100085964,
    -0.000000000169021168,
    -0.000000000243657406,
    -0.000000000318157106,
    -0.000000000386109917,
    -0.000000000441138333,
    -0.000000000477557413,
    -0.000000000491023872,
    -0.000000000479103723,
    -0.000000000441691123,
    -0.000000000381219875,
    -0.000000000302626885,
    -0.000000000213048845,
    -0.000000000121261208,
    -0.000000000036895828,
    0.000000000030498663,
    0.000000000072468670,
    0.000000000082638429,
    0.000000000057558493,
    -0.000000000002681159,
    -0.000000000094156670,
    -0.000000000209191869,
    -0.000000000336837352,
    -0.000000000463729472,
    -0.000000000575268640,
    -0.000000000657020068,
    -0.000000000696207206,
    -0.000000000683150094,
    -0.000000000612494092,
    -0.000000000484085687,
    -0.000000000303377431,
    -0.000000000081285514,
    0.000000000166526192,
    0.000000000420902631,
    0.000000000660903871,
    0.000000000865816179,
    0.000000001017281732,
    0.000000001101334223,
    0.000000001110123642,
    0.000000001043129377,
    0.000000000907701525,
    0.000000000718827526,
    0.000000000498095911,
    0.000000000271909027,
    0.000000000069079176,
    -0.000000000081985869,
    -0.000000000156244617,
    -0.000000000134836156,
    -0.000000000007446955,
    0.000000000226041999,
    0.000000000554844156,
    0.000000000957625368,
    0.000000001403962912,
    0.000000001856825276,
    0.000000002275883125,
    0.000000002621363534,
    0.000000002858086802,
    0.000000002959283083,
    0.000000002909785013,
    0.000000002708230916,
    0.000000002367993871,
    0.000000001916664244,
    0.000000001394052780,
    0.000000000848829665,
    0.000000000334063243,
    -0.000000000097951122,
    -0.000000000401084493,
    -0.000000000540452741,
    -0.000000000496642181,
    -0.000000000268602200,
    0.000000000125167733,
    0.000000000647355048,
    0.000000001244530548,
    0.000000001851640305,
    0.000000002397937629,
    0.000000002813831423,
    0.000000003038005958,
    0.000000003024102036,
    0.000000002746256220,
    0.000000002202871156,
    0.000000001418137109,
    0.000000000441026301,
    -0.000000000658274988,
    -0.000000001794273877,
    -0.000000002873943968,
    -0.000000003805675976,
    -0.000000004508560043,
    -0.000000004921076075,
    -0.000000005008278013,
    -0.000000004766663640,
    -0.000000004226112572,
    -0.000000003448541137,
    -0.000000002523236367,
    -0.000000001559167574,
    -0.000000000674894965,
    0.000000000013027896,
    0.000000000402062583,
    0.000000000414910065,
    0.000000000008773636,
    -0.000000000818380217,
    -0.000000002025352969,
    -0.000000003529485535,
    -0.000000005212711729,
    -0.000000006931505571,
    -0.000000008529919373,
    -0.000000009854556828,
    -0.000000010770068992,
    -0.000000011173636103,
    -0.000000011006919905,
    -0.000000010264149098,
    -0.000000008995320186,
    -0.000000007303936906,
    -0.000000005339230931,
    -0.000000003283360852,
    -0.000000001334617247,
    0.000000000311881464,
    0.000000001484188329,
    0.000000002052242116,
    0.000000001943342243,
    0.000000001152651501,
    -0.000000000252597128,
    -0.000000002135952583,
    -0.000000004301750427,
    -0.000000006511652017,
    -0.000000008506409966,
    -0.000000010030957582,
    -0.000000010860482023,
    -0.000000010824914726,
    -0.000000009829287960,
    -0.000000007867679085,
    -0.000000005028976088,
    -0.000000001493416576,
    0.000000002480287471,
    0.000000006576496967,
    0.000000010451216175,
    0.000000013765239819,
    0.000000016218830941,
    0.000000017584546979,
    0.000000017734811587,
    0.000000016661140510,
    0.000000014482565755,
    0.000000011441715491,
    0.000000007888129795,
    0.000000004249624283,
    0.000000000993746763,
    -0.000000001417516457,
    -0.000000002575747743,
    -0.000000002172235068,
    -0.000000000037510894,
    0.000000003830133941,
    0.000000009250844919,
    0.000000015866643942,
    0.000000023163183515,
    0.000000030509206550,
    0.000000037211359918,
    0.000000042580350488,
    0.000000046003016314,
    0.000000047013849979,
    0.000000045358976899,
    0.000000041045633093,
    0.000000034370840788,
    0.000000025924224937,
    0.000000016561682872,
    0.000000007348792321,
    -0.000000000524733192,
    -0.000000005855746391,
    -0.000000007557376414,
    -0.000000004799573965,
    0.000000002849202267,
    0.000000015289723224,
    0.000000031779848007,
    0.000000050852547918,
    0.000000070272729963,
    0.000000087039401054,
    0.000000097437079596,
    0.000000097137360647,
    0.000000081348390874,
    0.000000045006930853,
    -0.000000009782126045,
    -0.000000054428575882,
    -0.000000065577349388,
    -0.000000043116101539,
    -0.000000016191833783,
    -0.000000042761700854,
    -0.000000202135769239,
    -0.000000581198118382,
    -0.000001256182265404,
    -0.000002272841277072,
    -0.000003628430402108,
    -0.000005258997101409,
    -0.000007035002753199,
    -0.000008767311078958,
    -0.000010224175837857,
    -0.000011158216194886,
    -0.000011340700755320,
    -0.000010599008920742,
    -0.000008852128245734,
    -0.000006138663650651,
    -0.000002632193082941,
    0.000001360071955833,
    0.000005417551151428,
    0.000009045392624979,
    0.000011729735369806,
    0.000013003959800616,
    0.000012518641386072,
    0.000010106532261458,
    0.000005833476666602,
    0.000000026870840343,
    -0.000006724868673005,
    -0.000013605480029043,
    -0.000019636668239388,
    -0.000023772494498834,
    -0.000025014294754434,
    -0.000022534654312347,
    -0.000015796577031726,
    -0.000004653028925619,
    0.000010587237073207,
    0.000029139178603427,
    0.000049773760855519,
    0.000070905100555838,
    0.000090728288825335,
    0.000107397380424942,
    0.000119227295409141,
    0.000124898967232910,
    0.000123644625400645,
    0.000115390085477275,
    0.000100833559136102,
    0.000081445729883259,
    0.000059383300811127,
    0.000037317257036040,
    0.000018186809213583,
    0.000004899353343350,
    0.000000004705362067,
    0.000005377327717684,
    0.000021942432912210,
    0.000049480201250221,
    0.000086536747161703,
    0.000130461202498611,
    0.000177576081389694,
    0.000223474061222777,
    0.000263419862478879,
    0.000292822600011879,
    0.000307733371240746,
    0.000305316328219196,
    0.000284240093697155,
    0.000244940685065565,
    0.000189717081016807,
    0.000122635556609459,
    0.000049237676605586,
    -0.000023932379287134,
    -0.000089944788483561,
    -0.000142190627696674,
    -0.000175109408906574,
    -0.000184861527337542,
    -0.000169869660046596,
    -0.000131161448912013,
    -0.000072461975564134,
    -0.000000007419076521,
    0.000077921096596209,
    0.000151714736149380,
    0.000211347747945614,
    0.000247399593117447,
    0.000252088485983468,
    0.000220208120068931,
    0.000149861979855568,
    0.000042903664000424,
    -0.000094983644892744,
    -0.000254601941034509,
    -0.000423941466454469,
    -0.000589224849975967,
    -0.000736205975035127,
    -0.000851604656635488,
    -0.000924536021090768,
    -0.000947784714271706,
    -0.000918780510559876,
    -0.000840153853746373,
    -0.000719786007449948,
    -0.000570315916919520,
    -0.000408120302944736,
    -0.000251839633518074,
    -0.000120574654194352,
    -0.000031920382771852,
    -0.000000031850464281,
    -0.000033924618987115,
    -0.000136201170095933,
    -0.000302361649662192,
    -0.000520806321813219,
    -0.000773571689919808,
    -0.001037768556201655,
    -0.001287615525331872,
    -0.001496893348020665,
    -0.001641591539331795,
    -0.001702485338470204,
    -0.001667372966674484,
    -0.001532722583328313,
    -0.001304524890892356,
    -0.000998217701060235,
    -0.000637636988230486,
    -0.000253046872727007,
    0.000121601015248233,
    0.000451940390249752,
    0.000706688758252863,
    0.000861024474423487,
    0.000899488650318597,
    0.000818087475035287,
    0.000625334880502816,
    0.000342070137337450,
    0.000000001781277421,
    -0.000360942612514907,
    -0.000696254463202288,
    -0.000961151269407181,
    -0.001115148316207076,
    -0.001126441855514415,
    -0.000975645787449247,
    -0.000658465726845111,
    -0.000186981007292813,
    0.000410669911502295,
    0.001092252835429556,
    0.001804936667530283,
    0.002490051791560674,
    0.003088689396339295,
    0.003547615799806077,
    0.003824916645003260,
    0.003894783263277871,
    0.003750910641016910,
    0.003408090455418134,
    0.002901744794333839,
    0.002285342345314318,
    0.001625850776818516,
    0.000997585992514677,
    0.000474999665684854,
    0.000125081334115571,
    0.000000124436449785,
    0.000131606570024167,
    0.000525859326921869,
    0.001162056194170419,
    0.001992839516795129,
    0.002947657410747730,
    0.003938611924732931,
    0.004868356896234317,
    0.005639354602972944,
    0.006163629149042550,
    0.006372061537906541,
    0.006222269663134447,
    0.005704210551461207,
    0.004842827301872408,
    0.003697325134154068,
    0.002356977308936244,
    0.000933703454050493,
    -0.000448002807072675,
    -0.001662926706287107,
    -0.002597674268213496,
    -0.003162688313284933,
    -0.003302514333497130,
    -0.003003203706275512,
    -0.002295968937918873,
    -0.001256531525694687,
    -0.000000000214473171,
    0.001328449741786129,
    0.002566397990712104,
    0.003549422382723167,
    0.004127391616206955,
    0.004180260395246578,
    0.003631788119768393,
    0.002459722006732474,
    0.000701253069085478,
    -0.001547050275528532,
    -0.004135133114830051,
    -0.006870924612089687,
    -0.009536592315335400,
    -0.011908281627366634,
    -0.013777637756734991,
    -0.014973144897633123,
    -0.015379227774442086,
    -0.014951160486924315,
    -0.013724116135263049,
    -0.011815149593735613,
    -0.009417499956581261,
    -0.006787279479869842,
    -0.004223323183858534,
    -0.002041643695114946,
    -0.000546506317790316,
    -0.000000553392717732,
    -0.000596620556947817,
    -0.002433873007959944,
    -0.005500639457958422,
    -0.009665848338930524,
    -0.014680308710166776,
    -0.020188279040838135,
    -0.025748896357822765,
    -0.030866170365967682,
    -0.035025458280187931,
    -0.037733697722462808,
    -0.038560247353844855,
    -0.037175011278799637,
    -0.033380625909266021,
    -0.027135865590240803,
    -0.018568050616007206,
    -0.007973070864496008,
    0.004197395739751609,
    0.017360867244970775,
    0.030839645726566410,
    0.043904527106404384,
    0.055823454461192766,
    0.065911489218603125,
    0.073578316405256694,
    0.078369647235738193,
    0.079999325340117708,
    0.078369647235737638,
    0.073578316405256569,
    0.065911489218603625,
    0.055823454461192787,
    0.043904527106404051,
    0.030839645726566514,
    0.017360867244970959,
    0.004197395739751587,
    -0.007973070864496069,
    -0.018568050616007206,
    -0.027135865590240858,
    -0.033380625909266028,
    -0.037175011278799491,
    -0.038560247353844848,
    -0.037733697722462885,
    -0.035025458280187896,
    -0.030866170365967560,
    -0.025748896357822716,
    -0.020188279040838156,
    -0.014680308710166767,
    -0.009665848338930538,
    -0.005500639457958405,
    -0.002433873007959888,
    -0.000596620556947820,
    -0.000000553392717796,
    -0.000546506317790340,
    -0.002041643695114904,
    -0.004223323183858542,
    -0.006787279479869845,
    -0.009417499956581253,
    -0.011815149593735624,
    -0.013724116135263040,
    -0.014951160486924252,
    -0.015379227774442051,
    -0.014973144897633151,
    -0.013777637756734976,
    -0.011908281627366579,
    -0.009536592315335393,
    -0.006870924612089691,
    -0.004135133114830045,
    -0.001547050275528535,
    0.000701253069085477,
    0.002459722006732490,
    0.003631788119768383,
    0.004180260395246532,
    0.004127391616206950,
    0.003549422382723185,
    0.002566397990712095,
    0.001328449741786119,
    -0.000000000214473170,
    -0.001256531525694698,
    -0.002295968937918901,
    -0.003003203706275514,
    -0.003302514333497174,
    -0.003162688313284993,
    -0.002597674268213524,
    -0.001662926706287096,
    -0.000448002807072668,
    0.000933703454050491,
    0.002356977308936268,
    0.003697325134154107,
    0.004842827301872464,
    0.005704210551461275,
    0.006222269663134510,
    0.006372061537906594,
    0.006163629149042610,
    0.005639354602973008,
    0.004868356896234364,
    0.003938611924732970,
    0.002947657410747755,
    0.001992839516795137,
    0.001162056194170429,
    0.000525859326921896,
    0.000131606570024174,
    0.000000124436449764,
    0.000125081334115571,
    0.000474999665684870,
    0.000997585992514675,
    0.001625850776818513,
    0.002285342345314328,
    0.002901744794333863,
    0.003408090455418154,
    0.003750910641016943,
    0.003894783263277894,
    0.003824916645003276,
    0.003547615799806099,
    0.003088689396339319,
    0.002490051791560689,
    0.001804936667530296,
    0.001092252835429566,
    0.000410669911502291,
    -0.000186981007292817,
    -0.000658465726845102,
    -0.000975645787449256,
    -0.001126441855514434,
    -0.001115148316207083,
    -0.000961151269407176,
    -0.000696254463202293,
    -0.000360942612514918,
    0.000000001781277418,
    0.000342070137337455,
    0.000625334880502819,
    0.000818087475035294,
    0.000899488650318601,
    0.000861024474423490,
    0.000706688758252867,
    0.000451940390249754,
    0.000121601015248235,
    -0.000253046872727002,
    -0.000637636988230489,
    -0.000998217701060245,
    -0.001304524890892357,
    -0.001532722583328305,
    -0.001667372966674488,
    -0.001702485338470225,
    -0.001641591539331798,
    -0.001496893348020658,
    -0.001287615525331880,
    -0.001037768556201665,
    -0.000773571689919815,
    -0.000520806321813221,
    -0.000302361649662202,
    -0.000136201170095953,
    -0.000033924618987137,
    -0.000000031850464307,
    -0.000031920382771873,
    -0.000120574654194385,
    -0.000251839633518099,
    -0.000408120302944757,
    -0.000570315916919547,
    -0.000719786007449977,
    -0.000840153853746398,
    -0.000918780510559885,
    -0.000947784714271720,
    -0.000924536021090785,
    -0.000851604656635492,
    -0.000736205975035118,
    -0.000589224849975959,
    -0.000423941466454468,
    -0.000254601941034502,
    -0.000094983644892726,
    0.000042903664000440,
    0.000149861979855578,
    0.000220208120068943,
    0.000252088485983486,
    0.000247399593117457,
    0.000211347747945620,
    0.000151714736149385,
    0.000077921096596216,
    -0.000000007419076523,
    -0.000072461975564143,
    -0.000131161448912015,
    -0.000169869660046592,
    -0.000184861527337541,
    -0.000175109408906583,
    -0.000142190627696671,
    -0.000089944788483551,
    -0.000023932379287133,
    0.000049237676605582,
    0.000122635556609463,
    0.000189717081016822,
    0.000244940685065572,
    0.000284240093697154,
    0.000305316328219202,
    0.000307733371240760,
    0.000292822600011887,
    0.000263419862478884,
    0.000223474061222781,
    0.000177576081389703,
    0.000130461202498619,
    0.000086536747161704,
    0.000049480201250222,
    0.000021942432912219,
    0.000005377327717687,
    0.000000004705362063,
    0.000004899353343353,
    0.000018186809213589,
    0.000037317257036042,
    0.000059383300811122,
    0.000081445729883257,
    0.000100833559136104,
    0.000115390085477272,
    0.000123644625400641,
    0.000124898967232912,
    0.000119227295409148,
    0.000107397380424949,
    0.000090728288825335,
    0.000070905100555842,
    0.000049773760855531,
    0.000029139178603429,
    0.000010587237073207,
    -0.000004653028925615,
    -0.000015796577031713,
    -0.000022534654312338,
    -0.000025014294754432,
    -0.000023772494498833,
    -0.000019636668239385,
    -0.000013605480029048,
    -0.000006724868673016,
    0.000000026870840335,
    0.000005833476666601,
    0.000010106532261453,
    0.000012518641386058,
    0.000013003959800612,
    0.000011729735369809,
    0.000009045392624976,
    0.000005417551151420,
    0.000001360071955829,
    -0.000002632193082939,
    -0.000006138663650654,
    -0.000008852128245743,
    -0.000010599008920746,
    -0.000011340700755319,
    -0.000011158216194889,
    -0.000010224175837861,
    -0.000008767311078956,
    -0.000007035002753192,
    -0.000005258997101399,
    -0.000003628430402107,
    -0.000002272841277065,
    -0.000001256182265390,
    -0.000000581198118374,
    -0.000000202135769242,
    -0.000000042761700850,
    -0.000000016191833774,
    -0.000000043116101535,
    -0.000000065577349393,
    -0.000000054428575883,
    -0.000000009782126041,
    0.000000045006930850,
    0.000000081348390867,
    0.000000097137360649,
    0.000000097437079601,
    0.000000087039401060,
    0.000000070272729961,
    0.000000050852547922,
    0.000000031779848013,
    0.000000015289723224,
    0.000000002849202265,
    -0.000000004799573960,
    -0.000000007557376408,
    -0.000000005855746388,
    -0.000000000524733197,
    0.000000007348792317,
    0.000000016561682877,
    0.000000025924224934,
    0.000000034370840784,
    0.000000041045633098,
    0.000000045358976913,
    0.000000047013849989,
    0.000000046003016330,
    0.000000042580350508,
    0.000000037211359949,
    0.000000030509206583,
    0.000000023163183542,
    0.000000015866643972,
    0.000000009250844960,
    0.000000003830133974,
    -0.000000000037510863,
    -0.000000002172235051,
    -0.000000002575747717,
    -0.000000001417516449,
    0.000000000993746763,
    0.000000004249624285,
    0.000000007888129797,
    0.000000011441715483,
    0.000000014482565735,
    0.000000016661140492,
    0.000000017734811571,
    0.000000017584546954,
    0.000000016218830916,
    0.000000013765239800,
    0.000000010451216158,
    0.000000006576496952,
    0.000000002480287453,
    -0.000000001493416592,
    -0.000000005028976091,
    -0.000000007867679091,
    -0.000000009829287968,
    -0.000000010824914727,
    -0.000000010860482021,
    -0.000000010030957581,
    -0.000000008506409974,
    -0.000000006511652022,
    -0.000000004301750430,
    -0.000000002135952598,
    -0.000000000252597149,
    0.000000001152651486,
    0.000000001943342228,
    0.000000002052242100,
    0.000000001484188305,
    0.000000000311881446,
    -0.000000001334617257,
    -0.000000003283360870,
    -0.000000005339230945,
    -0.000000007303936910,
    -0.000000008995320182,
    -0.000000010264149095,
    -0.000000011006919904,
    -0.000000011173636094,
    -0.000000010770068980,
    -0.000000009854556820,
    -0.000000008529919372,
    -0.000000006931505567,
    -0.000000005212711716,
    -0.000000003529485529,
    -0.000000002025352974,
    -0.000000000818380214,
    0.000000000008773647,
    0.000000000414910069,
    0.000000000402062581,
    0.000000000013027897,
    -0.000000000674894959,
    -0.000000001559167572,
    -0.000000002523236375,
    -0.000000003448541141,
    -0.000000004226112576,
    -0.000000004766663651,
    -0.000000005008278028,
    -0.000000004921076088,
    -0.000000004508560047,
    -0.000000003805675982,
    -0.000000002873943980,
    -0.000000001794273884,
    -0.000000000658274990,
    0.000000000441026294,
    0.000000001418137104,
    0.000000002202871156,
    0.000000002746256225,
    0.000000003024102038,
    0.000000003038005952,
    0.000000002813831425,
    0.000000002397937633,
    0.000000001851640305,
    0.000000001244530539,
    0.000000000647355050,
    0.000000000125167737,
    -0.000000000268602202,
    -0.000000000496642186,
    -0.000000000540452742,
    -0.000000000401084488,
    -0.000000000097951125,
    0.000000000334063234,
    0.000000000848829665,
    0.000000001394052783,
    0.000000001916664243,
    0.000000002367993865,
    0.000000002708230916,
    0.000000002909785018,
    0.000000002959283081,
    0.000000002858086792,
    0.000000002621363533,
    0.000000002275883130,
    0.000000001856825274,
    0.000000001403962904,
    0.000000000957625366,
    0.000000000554844159,
    0.000000000226041995,
    -0.000000000007446961,
    -0.000000000134836156,
    -0.000000000156244610,
    -0.000000000081985865,
    0.000000000069079172,
    0.000000000271909026,
    0.000000000498095915,
    0.000000000718827522,
    0.000000000907701519,
    0.000000001043129378,
    0.000000001110123645,
    0.000000001101334225,
    0.000000001017281728,
    0.000000000865816178,
    0.000000000660903875,
    0.000000000420902629,
    0.000000000166526187,
    -0.000000000081285519,
    -0.000000000303377432,
    -0.000000000484085691,
    -0.000000000612494109,
    -0.000000000683150096,
    -0.000000000696207205,
    -0.000000000657020077,
    -0.000000000575268651,
    -0.000000000463729483,
    -0.000000000336837360,
    -0.000000000209191871,
    -0.000000000094156686,
    -0.000000000002681169,
    0.000000000057558497,
    0.000000000082638417,
    0.000000000072468656,
    0.000000000030498658,
    -0.000000000036895829,
    -0.000000000121261212,
    -0.000000000213048856,
    -0.000000000302626892,
    -0.000000000381219872,
    -0.000000000441691130,
    -0.000000000479103727,
    -0.000000000491023874,
    -0.000000000477557405,
    -0.000000000441138326,
    -0.000000000386109921,
    -0.000000000318157102,
    -0.000000000243657395,
    -0.000000000169021165,
    -0.000000000100085964,
    -0.000000000041619854,
    0.000000000003028082,
    0.000000000032108489,
    0.000000000045481992,
    0.000000000044473076,
    0.000000000031597065,
    0.000000000010198445,
    -0.000000000015954912,
    -0.000000000043078084,
    -0.000000000067735276,
    -0.000000000087134372,
    -0.000000000099327501,
    -0.000000000103308086,
    -0.000000000099004960,
    -0.000000000087185704,
    -0.000000000069288103,
    -0.000000000047204952,
    -0.000000000023048452,
    0.000000000001079450,
    0.000000000023288760,
    0.000000000042057751,
    0.000000000056333956,
    0.000000000065576017,
    0.000000000069739819,
    0.000000000069217120,
    0.000000000064739522,
    0.000000000057261906,
    0.000000000047840601,
    0.000000000037519201,
    0.000000000027233411,
    0.000000000017741562,
    0.000000000009584785,
    0.000000000003075885,
    -0.000000000001685969,
    -0.000000000004781219,
    -0.000000000006423160,
    -0.000000000006906520,
    -0.000000000006557564,
    -0.000000000005691790,
    -0.000000000004582253,
    -0.000000000003440606,
    -0.000000000002410139,
    -0.000000000001569333,
    -0.000000000000942729,
    -0.000000000000516216,
    -0.000000000000252960,
    -0.000000000000107883,
    -0.000000000000038292,
    -0.000000000000010500,
    -0.000000000000001928,
    -0.000000000000000196,
    -0.000000000000000021,
    -0.000000000000000018,
]

h = [
    -0.000000000000000001,
    -0.000000000000000002,
    0.000000000000431144,
    0.000000000000000003,
    0.000000000000871425,
    -0.000000000000000002,
    0.000000000001290923,
    0.000000000000000000,
    0.000000000001653152,
    0.000000000000000000,
    0.000000000001912943,
    -0.000000000000000003,
    0.000000000002015037,
    -0.000000000000000001,
    0.000000000001893556,
    -0.000000000000000004,
    0.000000000001472862,
    0.000000000000000000,
    0.000000000000669984,
    -0.000000000000000004,
    -0.000000000000601740,
    -0.000000000000000002,
    -0.000000000002427527,
    -0.000000000000000001,
    -0.000000000004884576,
    0.000000000000000000,
    -0.000000000008034702,
    0.000000000000000000,
    -0.000000000011916549,
    0.000000000000000001,
    -0.000000000016538180,
    0.000000000000000000,
    -0.000000000021869968,
    -0.000000000000000002,
    -0.000000000027838952,
    -0.000000000000000003,
    -0.000000000034325352,
    0.000000000000000000,
    -0.000000000041161306,
    0.000000000000000003,
    -0.000000000048132428,
    -0.000000000000000002,
    -0.000000000054982204,
    -0.000000000000000003,
    -0.000000000061419739,
    0.000000000000000003,
    -0.000000000067130124,
    -0.000000000000000003,
    -0.000000000071787315,
    -0.000000000000000004,
    -0.000000000075068831,
    0.000000000000000002,
    -0.000000000076671825,
    -0.000000000000000003,
    -0.000000000076329274,
    -0.000000000000000002,
    -0.000000000073825720,
    -0.000000000000000002,
    -0.000000000069011422,
    -0.000000000000000005,
    -0.000000000061813771,
    0.000000000000000005,
    -0.000000000052246548,
    0.000000000000000000,
    -0.000000000040413911,
    -0.000000000000000001,
    -0.000000000026511081,
    0.000000000000000000,
    -0.000000000010820375,
    -0.000000000000000005,
    0.000000000006297273,
    -0.000000000000000002,
    0.000000000024414754,
    -0.000000000000000001,
    0.000000000043054947,
    -0.000000000000000001,
    0.000000000061709517,
    0.000000000000000001,
    0.000001314773692832,
    0.000000250079552069,
    0.000012210343447525,
    0.000001026909465161,
    0.000034634419091511,
    0.000002346434982376,
    0.000068540721452014,
    0.000004186066053812,
    0.000112951791678944,
    0.000006473975109340,
    0.000165701384239364,
    0.000009075869863980,
    0.000223130785733632,
    0.000011780090496480,
    0.000279761704168682,
    0.000014282285182443,
    0.000327976320360266,
    0.000016171246692690,
    0.000357741014508611,
    0.000016917709466257,
    0.000356413475086056,
    0.000015867982489240,
    0.000308672850210912,
    0.000012244209748097,
    0.000196609037748398,
    0.000005152800276094,
    0.000000000124438137,
    -0.000006397839741758,
    -0.000303203344860860,
    -0.000023469690119185,
    -0.000736181605413333,
    -0.000047157690547696,
    -0.001322345665680711,
    -0.000078543304991059,
    -0.002084259110424935,
    -0.000118640617020920,
    -0.003042422354579888,
    -0.000168337199470210,
    -0.004213974182646294,
    -0.000228332612735310,
    -0.005611377078341162,
    -0.000299077854430050,
    -0.007241160984665802,
    -0.000380719365915026,
    -0.009102803926332828,
    -0.000473051266597972,
    -0.011187826833860326,
    -0.000575479316737270,
    -0.013479173708784212,
    -0.000686999701363269,
    -0.015950937085364221,
    -0.000806195095830216,
    -0.018568473048579524,
    -0.000931249647401057,
    -0.021288930662271586,
    -0.001059983531561251,
    -0.024062198629561354,
    -0.001189906672668432,
    -0.026832248651555805,
    -0.001318290120576903,
    -0.029538831705054655,
    -0.001442252516605083,
    -0.032119461799654268,
    -0.001558858131748483,
    -0.034511603113496936,
    -0.001665222180358275,
    -0.036654962001796007,
    -0.001758618557128258,
    -0.038493776235192428,
    -0.001836584854403673,
    -0.039978990650307425,
    -0.001897019514630498,
    -0.041070211507968968,
    -0.001938266265221133,
    -0.041737341184482038,
    -0.001959181557557250,
    0.958038193318152209,
    -0.001959181557557241,
    -0.041737341184482135,
    -0.001938266265221140,
    -0.041070211507968878,
    -0.001897019514630489,
    -0.039978990650307300,
    -0.001836584854403682,
    -0.038493776235192192,
    -0.001758618557128252,
    -0.036654962001796083,
    -0.001665222180358288,
    -0.034511603113497019,
    -0.001558858131748476,
    -0.032119461799654171,
    -0.001442252516605088,
    -0.029538831705054586,
    -0.001318290120576892,
    -0.026832248651555819,
    -0.001189906672668438,
    -0.024062198629561334,
    -0.001059983531561239,
    -0.021288930662271534,
    -0.000931249647401058,
    -0.018568473048579476,
    -0.000806195095830209,
    -0.015950937085364218,
    -0.000686999701363271,
    -0.013479173708784188,
    -0.000575479316737262,
    -0.011187826833860263,
    -0.000473051266597976,
    -0.009102803926332802,
    -0.000380719365915021,
    -0.007241160984665795,
    -0.000299077854430051,
    -0.005611377078341147,
    -0.000228332612735306,
    -0.004213974182646269,
    -0.000168337199470212,
    -0.003042422354579839,
    -0.000118640617020920,
    -0.002084259110424940,
    -0.000078543304991063,
    -0.001322345665680718,
    -0.000047157690547696,
    -0.000736181605413334,
    -0.000023469690119183,
    -0.000303203344860807,
    -0.000006397839741760,
    0.000000000124438144,
    0.000005152800276096,
    0.000196609037748388,
    0.000012244209748098,
    0.000308672850210899,
    0.000015867982489243,
    0.000356413475086072,
    0.000016917709466256,
    0.000357741014508627,
    0.000016171246692691,
    0.000327976320360236,
    0.000014282285182446,
    0.000279761704168672,
    0.000011780090496481,
    0.000223130785733629,
    0.000009075869863982,
    0.000165701384239381,
    0.000006473975109342,
    0.000112951791678929,
    0.000004186066053814,
    0.000068540721452006,
    0.000002346434982379,
    0.000034634419091513,
    0.000001026909465160,
    0.000012210343447527,
    0.000000250079552068,
    0.000001314773692830,
    -0.000000000000000001,
    0.000000000061709528,
    -0.000000000000000002,
    0.000000000043054955,
    -0.000000000000000001,
    0.000000000024414748,
    -0.000000000000000002,
    0.000000000006297257,
    -0.000000000000000001,
    -0.000000000010820368,
    0.000000000000000004,
    -0.000000000026511060,
    0.000000000000000001,
    -0.000000000040413903,
    0.000000000000000001,
    -0.000000000052246539,
    0.000000000000000001,
    -0.000000000061813783,
    0.000000000000000001,
    -0.000000000069011392,
    0.000000000000000000,
    -0.000000000073825704,
    -0.000000000000000002,
    -0.000000000076329263,
    0.000000000000000000,
    -0.000000000076671837,
    -0.000000000000000001,
    -0.000000000075068831,
    0.000000000000000000,
    -0.000000000071787310,
    0.000000000000000001,
    -0.000000000067130134,
    0.000000000000000002,
    -0.000000000061419725,
    -0.000000000000000002,
    -0.000000000054982206,
    0.000000000000000001,
    -0.000000000048132422,
    0.000000000000000001,
    -0.000000000041161303,
    0.000000000000000001,
    -0.000000000034325342,
    0.000000000000000003,
    -0.000000000027838941,
    -0.000000000000000001,
    -0.000000000021869951,
    0.000000000000000000,
    -0.000000000016538172,
    0.000000000000000002,
    -0.000000000011916552,
    0.000000000000000002,
    -0.000000000008034819,
    -0.000000000000000002,
    -0.000000000004884573,
    0.000000000000000001,
    -0.000000000002427539,
    0.000000000000000000,
    -0.000000000000601724,
    -0.000000000000000004,
    0.000000000000670024,
    0.000000000000000000,
    0.000000000001472863,
    -0.000000000000000005,
    0.000000000001893553,
    0.000000000000000000,
    0.000000000002015044,
    -0.000000000000000003,
    0.000000000001912945,
    -0.000000000000000003,
    0.000000000001653164,
    0.000000000000000001,
    0.000000000001290920,
    0.000000000000000000,
    0.000000000000871427,
    -0.000000000000000002,
    0.000000000000431165,
    0.000000000000000002,
    0.000000000000000013,
]
'''
'''
IIR FILTER:
b, a = signal.butter(8, [0.02, 0.2],"bandpass")
sig = signal.filtfilt(b,a,sig)
print(np.all(np.abs(np.roots(a))<1))
'''

sig = np.convolve(sig, h)[(len(h)-1)//2:]

i=0
#tempc is used to prevent two predictions from being too close; currently unused
tempc = -999
prev_maxx=0.5
while i<len(sig):
	if window_width < 150:
		window_width = 150
	if window_width > 300:
		window_width = 300
	windows_plotted.append(0.1)
	for j in range(window_width-1):
		windows_plotted.append(0)
	temp = sig[i:i+window_width]
	ind = max_index(temp)


	sample_shift = 0
	shaving_off = 0
	maxx = temp[ind]
	for q in range(len(temp)):
		c = i+q+sample_shift
		if c<len(windowing_result_plotform):
			#here I shave off a certain number of samples that are within range of the max and use tempc to make sure beats aren't too close
			if temp[q] >= (1-shaving_off)*maxx and c-tempc>0 and abs((maxx/prev_maxx)-1)<0.2:
				windowing_result_plotform[c] = 2.9

				tempc = c
				prev_maxx = maxx

				#The actual predictions:
				if len(ann_guess) > 1 and abs(ann_guess[len(ann_guess)-1]-c)>2:
					ann_guess.append(c)

			else:
				windowing_result_plotform[c] = 0


	#critical section; determines how much window changes based on location of beat
	mid_difference = ind-window_width//2

	if mid_difference == 0:
		direction = 1
	else:
		direction = int(mid_difference/abs(mid_difference))
		
	CONSTANT = 1.4
	window_width += int(CONSTANT*direction*np.arctan(abs(mid_difference)))
	
	
	i += window_width
	
###########
#  	End   #
#   of    #
#  window #
###########	


avg = [2*sigavg for n in range(len(sig))]

#print(signal.butter(4, 0.5, 'low'))



'''
transformed = sig
#print("FFT:\n", np.fft.fft(sig))
length = len(sig)
mx_sig = max(sig)
mx_trans = max(transformed)
pyplot.plot([0 if n<length else sig[n-length] for n in range(2*length)], 'blue')
pyplot.plot(transformed, 'red')

'''
pyplot.plot(windowing_result_plotform, 'yellow')
pyplot.plot(windows_plotted, 'red')
pyplot.plot(ann_to_plot(sig, annsamp, 2), 'magenta')
pyplot.plot(arr)
pyplot.plot(sig)
#pyplot.plot(avg, 'green')

'''
Below is example of Fast Fourier Transform from scipy>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
'''
'''
N = 600
# sample spacing
T = 1.0 / 800.0
x = np.linspace(0.0, N*T, N)
y = np.sin(50.0 * 2.0*np.pi*x) + 0.5*np.sin(200.0 * 2.0*np.pi*x)
yf = scipy.fftpack.fft(y)
print(yf)
xf = np.linspace(0.0, 1.0/(2.0*T), N/2)

fig, ax = pyplot.subplots()
ax.plot(xf, 2.0/N * np.abs(yf[:N//2]))
'''
'''
End of example>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
'''

pyplot.show()


